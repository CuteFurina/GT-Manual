import{_ as a}from"./Pagination.js";import{_ as e}from"./MainCover.js";import{_ as l,g as t,a as s,q as u,u as r,e as o}from"./index.js";import{a7 as n,r as d,w as i,f as c,g as p,G as v,k as y,j as m,n as f,i as h,L as g,T as _,Y as C,aa as k,ac as q,P as b,R as j,J as L,K as z,X as w,W as N,a1 as R,O as S,a_ as x,at as P,ag as T,ai as U,aj as G}from"./vendor.js";import"./album2.js";import"./dj2.js";const I={class:"dsc-playlists"},J={class:"cat-header"},K={key:0,class:"all-cat"},M={key:1,class:"error"},O=l({__name:"playlists",setup(l){const O=t(),W=s(),X=n(),Y=d(Number(X.currentRoute.value.query?.page)||1),$=d(X.currentRoute.value.query?.cat||"全部歌单"),A=d("true"===X.currentRoute.value.query?.hq),B=d(!1),D=d([]),E=d(!1),F=d(!1),H=d(0),Q=(a="全部歌单",e=W.loadSize,l=0)=>{try{const t=D.value.length,s=t>0?D.value[t-1].updateTime:null;r(a,e,l,A.value,s).then((a=>{H.value=a.total,A.value?(a.more?E.value=!0:E.value=!1,F.value=!1,D.value.push(...u(a.playlists))):(D.value=[],D.value=u(a.playlists))}))}catch(t){E.value=!1,console.error("歌单列表获取失败：",t),$message.error("歌单列表获取失败")}},V=a=>{D.value=[],X.push({path:"/discover/playlists",query:{cat:$.value,hq:!!a}})},Z=a=>{D.value=[],X.push({path:"/discover/playlists",query:{cat:a,page:1}}),B.value=!1},aa=a=>{D.value=[],X.push({path:"/discover/playlists",query:{cat:$.value,page:a}})};return i((()=>X.currentRoute.value),(a=>{"dsc-playlists"===a.name&&(Y.value=Number(a.query?.page)||1,$.value=a.query?.cat||"全部歌单",A.value="true"===a.query?.hq,Q($.value,W.loadSize,(Y.value-1)*W.loadSize))})),c((()=>{O.setPlCatList(),Q($.value,W.loadSize,(Y.value-1)*W.loadSize)})),(l,t)=>{const s=o,u=N,r=R,n=S,d=x,i=k,c=e,W=a,X=P,ea=T,la=U,ta=G,sa=q;return p(),v("div",I,[y(i,{class:"menu",align:"center",justify:"space-between"},{default:m((()=>[y(r,{class:"cat","icon-placement":"right",strong:"",secondary:"",round:"",onClick:t[0]||(t[0]=a=>B.value=!0)},{icon:m((()=>[y(u,{class:"more",depth:"3"},{default:m((()=>[y(s,{icon:"chevron-right"})])),_:1})])),default:m((()=>[b(" "+j(f($)),1)])),_:1}),y(_,{name:"fade",mode:"out-in"},{default:m((()=>{return[(a=f(O).plCatList.hqCatList,e=f($),a?.length<=0||"全部歌单"!=e&&!a.some((a=>a.name==e))?g("",!0):(p(),h(i,{key:0,align:"center"},{default:m((()=>[y(n,null,{default:m((()=>[b("精品歌单")])),_:1}),y(d,{value:f(A),"onUpdate:value":[t[1]||(t[1]=a=>C(A)?A.value=a:null),V],round:!1},null,8,["value"])])),_:1})))];var a,e})),_:1})])),_:1}),y(c,{data:f(D)},null,8,["data"]),f(A)?g("",!0):(p(),h(W,{key:0,totalCount:f(H),pageNumber:f(Y),onPageNumberChange:aa},null,8,["totalCount","pageNumber"])),y(_,{name:"fade",mode:"out-in"},{default:m((()=>[y(i,{justify:"center"},{default:m((()=>[f(A)&&f(E)?(p(),h(r,{key:0,loading:f(F),class:"load-more",size:"large",strong:"",secondary:"",round:"",onClick:t[2]||(t[2]=()=>{F.value=!0,Q(f($))})},{default:m((()=>[b(" 加载更多 ")])),_:1},8,["loading"])):g("",!0)])),_:1})])),_:1}),y(sa,{show:f(B),"onUpdate:show":t[4]||(t[4]=a=>C(B)?B.value=a:null),bordered:!1,preset:"card"},{header:m((()=>[L("div",J,[y(n,null,{default:m((()=>[b("歌单分类")])),_:1}),y(X,{type:"全部歌单"==f($)?"primary":"default",bordered:!1,round:"",class:"tag",onClick:t[3]||(t[3]=a=>Z("全部歌单"))},{default:m((()=>[b(" 全部歌单 ")])),_:1},8,["type"])])])),default:m((()=>[y(ta,{style:{"max-height":"70vh"}},{default:m((()=>[f(O).plCatList.catList?.length?(p(),v("div",K,[y(la,null,{default:m((()=>[(p(!0),v(z,null,w(f(O).plCatList.allCat,((a,e)=>(p(),h(ea,{key:a},{prefix:m((()=>[y(n,{class:"type"},{default:m((()=>[b(j(a),1)])),_:2},1024)])),default:m((()=>[y(i,null,{default:m((()=>[(p(!0),v(z,null,w(f(O).plCatList.catList.filter((a=>a.category==e)),(a=>(p(),h(X,{key:a,bordered:!1,type:a.name==f($)?"primary":"default",round:"",class:"tag",size:"large",onClick:e=>Z(a.name)},{icon:m((()=>[a.hot?(p(),h(u,{key:0,class:"hot"},{default:m((()=>[y(s,{icon:"fire"})])),_:1})):g("",!0)])),default:m((()=>[b(j(a.name)+" ",1)])),_:2},1032,["type","onClick"])))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1})])):(p(),v("div",M,[y(n,null,{default:m((()=>[b("加载失败")])),_:1})]))])),_:1})])),_:1},8,["show"])])}}},[["__scopeId","data-v-edb16e58"]]);export{O as default};
