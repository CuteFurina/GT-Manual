import{_ as a}from"./SongList.js";import{a7 as e,s,r as l,w as t,e as o,n as i,g as c,G as n,k as r,j as u,T as d,O as p,aa as m,a1 as f,J as v,P as g,R as y,i as _,L as k,K as b,X as h,W as w,Y as z,ah as j,at as C,b1 as x,aJ as I,au as $,ad as q,a0 as L,ap as R,aq as A,v as S}from"./vendor.js";import{_ as T,g as J,q as K,C as N,e as O,z as P,K as U,B,d as D,F,i as G,f as W}from"./index.js";import{g as X,l as Y}from"./album2.js";import"./Pagination.js";const E={key:0,class:"album"},H={key:0,class:"detail"},M={class:"cover"},Q=(a=>(R("data-v-b8d2a39c"),a=a(),A(),a))((()=>v("div",{class:"cover-loading"},[v("img",{class:"loading-img",src:W,alt:"song"})],-1))),V={class:"data"},Z={key:1,class:"creator"},aa={key:0,class:"num-item"},ea={key:1,class:"num-item"},sa={key:2,class:"num-item"},la={key:1,class:"detail"},ta={class:"data"},oa={key:1,class:"title"},ia=T({__name:"album",setup(R){const A=e(),T=J(),{userLikeData:W}=s(T),ia=l(A.currentRoute.value.query.id||null),ca=l(null),na=l(null),ra=l(null),ua=l([]),da=l([{label:"打开源页面链接",key:"open",props:{onclick:()=>{const a=ia.value;a&&window.open(`https://music.163.com/#/album?id=${a}`)}},icon:(pa="link",()=>S(w,null,{default:()=>S(O,{icon:pa},null)}))}]);var pa;const ma=async(a,e=!1)=>{if(!a)return!1;ca.value=null,e||(na.value=null);const s=await X(a);if(ca.value=K(s.album,"album")[0],e)return!0;const l=s.songs.map((a=>a.id)).join(","),t=await N(l);na.value=K(t.songs,"song")},fa=D((a=>{const e=a?.trim();if(!e||""===e)return!0;const s=F(e,na.value);ua.value=s}),300),va=a=>{const e=W.value.albums;return!e.length||!e.some((e=>e.id===Number(a)))},ga=D((async a=>{try{if(!G())return $message.warning("请登录后使用");const e=va(a)?1:2;200===(await Y(e,a)).code?($message.success((1===e?"收藏":"取消收藏")+"成功"),await T.setUserLikeAlbums()):$message.error((1===e?"收藏":"取消收藏")+"失败，请重试")}catch(e){console.error("收藏出错：",e),$message.error("收藏操作出现错误")}}),300);return t((()=>A.currentRoute.value),(a=>{"album"===a.name&&(ia.value=a.query?.id,ma(ia.value))})),o((()=>{ma(ia.value)})),(e,s)=>{const l=j,t=p,o=C,R=m,S=x,T=I,J=f,K=$,N=q,D=a,F=L;return i(ia)&&Number(i(ia))?(c(),n("div",E,[r(d,{name:"fade",mode:"out-in"},{default:u((()=>[i(ca)&&Object.keys(i(ca))?.length?(c(),n("div",H,[v("div",M,[r(l,{src:i(ca).coverSize.l,"previewed-img-props":{style:{borderRadius:"8px"}},"preview-src":i(ca).cover,class:"cover-img","show-toolbar-tooltip":"",onLoad:s[0]||(s[0]=a=>{a.target.style.opacity=1})},{placeholder:u((()=>[Q])),_:1},8,["src","preview-src"]),r(l,{src:i(ca).coverSize.m,class:"cover-shadow","preview-disabled":""},null,8,["src"])]),v("div",V,[r(t,{class:"name"},{default:u((()=>[g(y(i(ca).name||"未知专辑"),1)])),_:1}),i(ca).alia?(c(),_(t,{key:0,class:"alia",depth:"3"},{default:u((()=>[g(y(i(ca).alia),1)])),_:1})):k("",!0),i(ca).artists?(c(),n("div",Z,[(c(!0),n(b,null,h(i(ca).artists,((a,e)=>(c(),_(t,{key:e,class:"ar",onClick:e=>i(A).push(`/artist?id=${a.id}`)},{default:u((()=>[g(y(a.name),1)])),_:2},1032,["onClick"])))),128))])):k("",!0),i(ca)?.tags?(c(),_(R,{key:2,class:"tags"},{default:u((()=>[(c(!0),n(b,null,h(i(ca).tags,((a,e)=>(c(),_(o,{key:e,bordered:!1,class:"pl-tags",round:"",onClick:e=>i(A).push({path:"/discover/albums",query:{cat:a}})},{default:u((()=>[g(y(a),1)])),_:2},1032,["onClick"])))),128))])),_:1})):k("",!0),r(R,{class:"num"},{default:u((()=>[i(ca).count?(c(),n("div",aa,[r(i(w),{depth:"3",size:"18"},{default:u((()=>[r(i(O),{icon:"music-note"})])),_:1}),r(t,{depth:"3"},{default:u((()=>[g(y(i(ca).count),1)])),_:1})])):k("",!0),i(ca).share?(c(),n("div",ea,[r(i(w),{depth:"3",size:"18"},{default:u((()=>[r(i(O),{icon:"share"})])),_:1}),r(t,{depth:"3"},{default:u((()=>[g(y(i(P)(i(ca)?.share||0)),1)])),_:1})])):k("",!0),i(ca).publishTime?(c(),n("div",sa,[r(i(w),{depth:"3",size:"18"},{default:u((()=>[r(i(O),{icon:"clock"})])),_:1}),r(t,{depth:"3"},{default:u((()=>[g(y(i(U)(i(ca).publishTime))+" 发布",1)])),_:1})])):k("",!0)])),_:1}),i(ca).description?(c(),_(S,{key:3,tooltip:!1,class:"description","expand-trigger":"click","line-clamp":"2"},{default:u((()=>[r(t,{depth:"3"},{default:u((()=>[g(y(i(ca).description),1)])),_:1})])),_:1})):(c(),_(t,{key:4,class:"description"},{default:u((()=>[g("太懒了吧，连简介都没写")])),_:1}))])])):(c(),n("div",la,[r(T,{class:"cover"}),v("div",ta,[r(T,{repeat:4,text:""})])]))])),_:1}),r(R,{class:"menu",justify:"space-between"},{default:u((()=>[r(R,{class:"left"},{default:u((()=>[r(J,{disabled:"empty"===i(na),focusable:!1,type:"primary",class:"play",tag:"div",circle:"",strong:"",secondary:"",onClick:s[1]||(s[1]=a=>i(B)(i(na)))},{icon:u((()=>[r(i(w),{size:"32"},{default:u((()=>[r(i(O),{icon:"play-arrow-rounded"})])),_:1})])),_:1},8,["disabled"]),r(J,{focusable:!1,class:"like",size:"large",tag:"div",round:"",strong:"",secondary:"",onClick:s[2]||(s[2]=a=>i(ga)(i(ia)))},{icon:u((()=>[r(i(w),null,{default:u((()=>[r(i(O),{icon:va(i(ia))?"favorite-outline-rounded":"favorite-rounded"},null,8,["icon"])])),_:1})])),default:u((()=>[g(" "+y(va(i(ia))?"收藏专辑":"取消收藏"),1)])),_:1}),r(K,{options:i(da),trigger:"hover",placement:"bottom-start"},{default:u((()=>[r(J,{focusable:!1,class:"more",size:"large",tag:"div",circle:"",strong:"",secondary:""},{icon:u((()=>[r(i(w),null,{default:u((()=>[r(i(O),{icon:"format-list-bulleted"})])),_:1})])),_:1})])),_:1},8,["options"])])),_:1}),r(R,{class:"right"},{default:u((()=>[r(d,{name:"fade",mode:"out-in"},{default:u((()=>["empty"!==i(na)&&i(na)?.length?(c(),_(N,{key:0,value:i(ra),"onUpdate:value":s[3]||(s[3]=a=>z(ra)?ra.value=a:null),"input-props":{autoComplete:!1},class:"search",placeholder:"模糊搜索",clearable:"",onInput:i(fa)},{prefix:u((()=>[r(i(w),{size:"18"},{default:u((()=>[r(i(O),{icon:"search-rounded"})])),_:1})])),_:1},8,["value","onInput"])):k("",!0)])),_:1})])),_:1})])),_:1}),r(d,{name:"fade",mode:"out-in"},{default:u((()=>[i(ra)?i(ua)?.length?(c(),_(D,{key:1,data:i(ua),sourceId:i(ia),showAlbum:!1},null,8,["data","sourceId"])):(c(),_(F,{key:2,description:`搜不到关于 ${i(ra)} 的任何歌曲呀`,style:{"margin-top":"60px"},size:"large"},{icon:u((()=>[r(i(w),null,{default:u((()=>[r(i(O),{icon:"search-off"})])),_:1})])),_:1},8,["description"])):(c(),_(D,{key:0,data:i(na),sourceId:i(ia),showAlbum:!1},null,8,["data","sourceId"]))])),_:1})])):(c(),n("div",oa,[r(t,{class:"key"},{default:u((()=>[g("参数不完整")])),_:1}),r(J,{focusable:!1,class:"back",strong:"",secondary:"",onClick:s[4]||(s[4]=a=>i(A).go(-1))},{default:u((()=>[g(" 返回上一页 ")])),_:1})]))}}},[["__scopeId","data-v-b8d2a39c"]]);export{ia as default};
