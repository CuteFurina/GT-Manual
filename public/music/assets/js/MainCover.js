import{_ as e,g as a,m as s,s as t,b as l,p as r,e as i,q as o,i as d,J as c,a as n,O as p}from"./index.js";import{a7 as u,s as y,r as m,M as v,g,G as f,k as _,j as k,T as h,n as w,i as b,V as C,W as j,a1 as x,K as z,U as S,J as q,L as $,R as N,P as D,X as I,ah as R,O as L,aw as M,a2 as J,a3 as P,aJ as T}from"./vendor.js";import{g as B}from"./album2.js";import{b as O}from"./dj2.js";const A=e({__name:"CoverPlayBtn",props:{id:{type:Number,required:!0},type:{type:String,default:"playlist"}},setup(e){const n=u(),p=a(),z=s(),S=t(),{userLikeData:q}=y(p),{playList:$,playSongData:N}=y(z),{playIndex:D,playMode:I,playHeartbeatMode:R,playState:L}=y(S),M=e,J=m(!1),P=m(null),T=v((()=>{if(!P.value||400===P.value)return-1;const e=z.getPlaySongData?.id;return P.value.findIndex((a=>a.id===e))})),A=async()=>{try{if(!M.id)return!1;if("mv"!==M.type)if(-1===T.value){if(J.value=!0,P.value=await(async()=>{switch(M.type,M.id,M.type){case"playlist":if(1024===M.id){const e=q.value.playlists?.[0]?.id||null;if(!d()||!e)return 400;const a=await c(e,500);return o(a.songs,"song")}{const e=await c(M.id,500);return o(e.songs,"song")}case"album":{const e=await B(M.id);return o(e.songs,"song")}case"dj":{const e=await O(M.id,500);return o(e.programs,"dj")}default:return null}})(),P.value,!P.value)return J.value=!1,$message.error("获取播放列表时出现错误");if(400===P.value)return J.value=!1,$message.error("请登录后使用");R.value=!1,I.value="dj"===M.type?"dj":"normal",$.value=P.value.slice(),N.value=P.value[0],D.value=0,await l(!0),J.value=!1,$message.info("已开始播放",{showIcon:!1})}else N.value=P.value[T.value],D.value=T.value,r();else n.push({path:"/videos-player",query:{id:M.id}})}catch(e){console.error("获取播放列表时出现错误：",e),$message.error("获取播放列表时出现错误")}};return(e,a)=>{const s=i,t=j,l=x;return g(),f("div",{class:"play-btn",onClick:a[0]||(a[0]=C((()=>{}),["stop"]))},[_(l,{loading:w(J),color:"#efefef",tag:"div",type:"primary",class:"play",size:"large",strong:"",secondary:"",circle:"",onClick:C(A,["stop"])},{icon:k((()=>[_(h,{name:"fade",mode:"out-in"},{default:k((()=>[(g(),b(t,{key:`${w(T)}-${w(L)}`,size:"50"},{default:k((()=>[_(s,{icon:-1!==w(T)&&w(L)?"pause-circle":"play-circle"},null,8,["icon"])])),_:1}))])),_:1})])),_:1},8,["loading"])])}}},[["__scopeId","data-v-a805d070"]]),G={class:"cover-img"},H=["src"],K={key:1,class:"additional"},U={class:"cover-content"},V={key:2,class:"artists"},W={key:3,class:"size"},X={class:"cover-content"},E=e({__name:"MainCover",props:{type:{type:String,default:"playlist"},data:{type:Array,default:()=>[]},columns:{type:String,default:"2 s:3 m:4 l:5 xl:6"},gridCollapsed:{type:Boolean,default:!1},gridCollapsedRows:{type:Number,default:3},loadingNum:{type:Number}},setup(e){const a=u(),s=n(),t=e,l=m(null),r=m(t.loadingNum||s.loadSize||50);return(s,t)=>{const o=R,d=L,c=A,n=i,u=j,y=M,m=J,v=P,x=T,B=p;return g(),f(z,null,[_(h,{name:"fade",mode:"out-in"},{default:k((()=>[e.data?.length?(g(),b(v,{key:0,cols:e.columns,collapsed:e.gridCollapsed,"collapsed-rows":e.gridCollapsedRows,class:"cover-lists",responsive:"screen","x-gap":"20","y-gap":"20"},{default:k((()=>[(g(!0),f(z,null,I(e.data,((s,r)=>(g(),b(m,{key:r,onClick:C((t=>((e,s)=>{try{switch(s){case"mv":a.push({path:"/videos-player",query:{id:e?.id}});break;case"playlist":a.push({path:"/playlist",query:{id:e?.id}});break;case"album":a.push({path:"/album",query:{id:e?.id}});break;case"artist":a.push({path:"/artist",query:{id:e?.id}});break;case"dj":a.push({path:"/dj",query:{id:e?.id}})}}catch(t){$message.error("跳转出错，请上报错误至开发者"),console.error("跳转出错：",t)}})(s,e.type)),["stop"]),onContextmenu:a=>w(l)?.openDropdown(a,e.type,s.id)},{default:k((()=>[_(y,{class:S(["cover-item",e.type]),"content-style":{padding:"artist"===e.type?0:"16px"}},{default:k((()=>[q("div",G,[_(o,{src:"mv"===e.type?s.coverSize:s.coverSize.m,class:"cover-main-img","preview-disabled":"",lazy:"",onLoad:t[0]||(t[0]=e=>{e.target.style.opacity=1})},{placeholder:k((()=>[q("div",{class:S(["cover-loading",e.type])},[q("img",{class:"loading-img",src:"mv"===e.type?"/music/images/pic/video.png?assest":"artist"===e.type?"/music/images/pic/artist.jpg?assest":"/music/images/pic/album.jpg?assest",alt:"song"},null,8,H)],2)])),_:2},1032,["src"]),"artist"===e.type?(g(),b(o,{key:0,class:"cover-main-shadow",lazy:"","preview-disabled":"",src:s.coverSize.m},null,8,["src"])):$("",!0),s.desc?(g(),f("div",K,[_(d,{class:"add-desc"},{default:k((()=>[D(N(s.desc),1)])),_:2},1024)])):$("",!0),"artist"!==e.type?(g(),b(c,{key:2,id:s.id,type:e.type},null,8,["id","type"])):(g(),b(u,{key:3,class:"play-btn"},{default:k((()=>[_(n,{icon:"account-music"})])),_:1}))]),q("div",U,[_(d,{class:"name"},{default:k((()=>[D(N(s.name),1)])),_:2},1024),s?.creator?(g(),b(d,{key:0,class:"creator",depth:"3"},{default:k((()=>[D(N(s.creator?.nickname||s.creator||"未知"),1)])),_:2},1024)):$("",!0),s?.rcmdText?(g(),b(d,{key:1,class:"creator",depth:"3"},{default:k((()=>[D(N(s.rcmdText||"未知简介"),1)])),_:2},1024)):$("",!0),s.artists&&"dj"!==e.type?(g(),f("div",V,[(g(!0),f(z,null,I(s.artists,(e=>(g(),b(d,{key:e.id,class:"ar",onClick:C((s=>w(a).push(`/artist?id=${e.id}`)),["stop"])},{default:k((()=>[D(N(e.name||e.userName),1)])),_:2},1032,["onClick"])))),128))])):$("",!0),"artist"===e.type&&s.size.music?(g(),f("div",W,[_(u,{depth:"3",size:"16"},{default:k((()=>[_(n,{icon:"artist"!==e.type?"play-circle":"music-note"},null,8,["icon"])])),_:1}),_(d,{depth:"3"},{default:k((()=>[D(N(s.size.music),1)])),_:2},1024)])):$("",!0)])])),_:2},1032,["class","content-style"])])),_:2},1032,["onClick","onContextmenu"])))),128))])),_:1},8,["cols","collapsed","collapsed-rows"])):(g(),b(v,{key:1,cols:e.columns,collapsed:e.gridCollapsed,"collapsed-rows":e.gridCollapsedRows,class:"cover-lists-loading",responsive:"screen","x-gap":"20","y-gap":"20"},{default:k((()=>[(g(!0),f(z,null,I(w(r),(a=>(g(),b(m,{key:a},{default:k((()=>[_(y,{class:S(["cover-item",e.type]),"content-style":"padding: 16px"},{default:k((()=>[_(x,{class:"cover-img"}),q("div",X,[_(x,{text:"",round:"",repeat:2})])])),_:1},8,["class"])])),_:2},1024)))),128))])),_:1},8,["cols","collapsed","collapsed-rows"]))])),_:1}),_(B,{ref_key:"coverDropdownRef",ref:l},null,512)],64)}}},[["__scopeId","data-v-a7ad13db"]]);export{E as _,A as a};
